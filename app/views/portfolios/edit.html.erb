<h2 class="text-2xl text-center">ポートフォリオ作成</h2> 
  <div class="lg:max-w-200 mx-auto mt-20">
    <%= form_with model: @portfolio, local: true, data: { turbo: false } do |f| %>
      <div>
        <%=f.label :title, "タイトル", class:"block tracking-wide text-gray-700 text-xl font-bold mb-2"%>
        <%=f.text_field :title, required: true, class:"mx-auto block appearance-none block w-full text-gray-700 border border-gray-500 rounded py-3 px-4 mb-3 leading-tight focus:outline-none bg-gray-200 focus:bg-white"%>
      </div>
      <div>
        <%=f.label :body, "自己紹介文", class:"block tracking-wide text-gray-700 text-xl font-bold mb-2"%>
        <%=f.text_area :body, required: true, class: "mx-auto  block h-100 appearance-none block w-full text-gray-700 border border-gray-500 rounded py-3 px-4  leading-tight focus:outline-none focus:bg-white bg-gray-200 resize-none"%>
      </div>
   
      <%= f.label :images, "画像を選択",
        class: "inline-block cursor-pointer rounded-md my-4 bg-gray-500 px-6 py-2 text-white hover:bg-blue-700 transition "%>
        <%# edit用 %>
        <div id="image-preview-container" class="flex flex-wrap mx-auto gap-4 mb-4 ">
          <% if @portfolio.images.attached? %>
            <% @portfolio.images.each do |image| %>
              <%= image_tag image, size: "150x150", class: "object-cover rounded" %>
            <% end %>
          <% end %>
        </div>


      <%= f.file_field :images, multiple: true, required: true,
      class: "hidden", onchange: "setImage(this);", accept: "image/jpeg,image/gif,image/png"%>

    <%= f.submit "作成",
      class: "block w-full py-2 cursor-pointer rounded-md bg-blue-500 text-xl font-bold text-white hover:bg-blue-700 transition active:scale-110 " %>
    <%end%>
  </div>
<script>
  const previewContainer = document.getElementById("image-preview-container")
  //document.getElementById("image-upload-field").addEventListener("change", (event) => {
  function setImage(input){
    if (!input.files) return;
        previewContainer.innerHTML = "";
        for (const file of input.files){
          const imageUrl = URL.createObjectURL(file);
          //前方一致か？
          if (!file.type.startsWith("image/")) continue;
          //imgタグの作成
          const img = document.createElement("img")
          img.src = imageUrl;
          img.style.width = "150px";
          img.style.height = "auto";
          img.style.objectFit = "cover";
          img.classList.add("rounded", "preview-img");
          img.onload = () => {
            URL.revokeObjectURL(imageUrl); 
          };
          previewContainer.appendChild(img)
      }};
</script>

